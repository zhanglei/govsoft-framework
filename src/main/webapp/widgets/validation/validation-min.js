(function(){var j=window.Validation;var D=function(K,J){this.initialize.apply(this,arguments)};D.version="1.2.8";function g(M,J,O){if(typeof M==="object"&&typeof M.length==="number"){for(var L=0,N=M.length;L<N;++L){if(J.call(O,M[L],L,M)===false){break}}}else{for(var K in M){if(J.call(O,M[K],K,M)===false){break}}}return M}function d(L,J,M){var K=true;g(L,function(O,N){if(!J.call(M,O,N,L)){K=false;return false}});return K}function s(L,J,M){var K=false;g(L,function(O,N){if(J.call(M,O,N,L)){K=true;return false}});return K}function C(){var L=arguments[0]||{};for(var K=1,N=arguments.length;K<N;++K){var M=arguments[K];for(var J in M){if(M[J]!==undefined){L[J]=M[J]}}}return L}function u(J){return !J||J.length==0||/^\s+$/.test(J)}function p(J){return J!==null&&typeof J==="object"&&J.splice&&J.join&&J.sort}function G(J){return p(J)?J:[J]}function A(J){return(J||"").replace(/^\s+|\s+$/g,"")}function I(J,K){return function(){return J.apply(K||this,arguments)}}var w=k;function k(J){return(typeof J==="string")?document.getElementById(J):J}function r(J){return J.tagName.toLowerCase()}function e(M){var J=r(M);if(J=="select"){var K=[];g(M.options,function(N){N.selected&&K.push(N.value)});return M.multiple?K:K[0]}else{if(J=="input"){var L=M.type.toLowerCase();if((L=="checkbox"||L=="radio")&&!M.checked){return false}}}return M.value}var v={},l="validation"+new Date().getTime(),z=0,F={};function H(M,J,K){M=(M==window)?F:M;var L=M[l];if(!L){L=M[l]=++z}v[L]=v[L]||{};if(K!==undefined){v[L][J]=K}return v[L][J]}function a(M,J){M=(M==window)?F:M;var L=M[l];if(!v[L]){return}delete v[L][J];J="";for(J in v){break}if(!J){try{delete M[l]}catch(K){M.removeAttribute&&M.removeAttribute(l)}delete v[L]}}function x(L,K,J){if(L.addEventListener){L.addEventListener(K,J,false)}else{if(L.attachEvent){L.attachEvent("on"+K,J)}}}function y(L,K,J){if(L.removeEventListener){L.removeEventListener(K,J,false)}else{if(L.detachEvent){L.detachEvent("on"+K,J)}}}function B(J){J=J||window.event;J.returnValue=false;J.preventDefault&&J.preventDefault()}function c(J){return(J.className||"").split(/\s+/)}function b(K,J){return s(c(K),function(L){return L==J})}function q(K,J){if(!b(K,J)){K.className+=(K.className?" ":"")+J}}function t(L,K){var J=[];g(c(L),function(M){M!=K&&J.push(M)});L.className=J.join(" ")}function n(K){var J=[];g(K.getElementsByTagName("*"),function(M){var L=r(M);if(L=="input"||L=="select"||L=="textarea"){J.push(M)}});return J}function E(L,K){if(D.show){return D.show(L,K)}if(D.show===false){L.style.display="";K&&K();return}if(typeof jQuery!=="undefined"){jQuery(L).fadeIn("slow",K)}else{if(typeof Prototype!=="undefined"&&typeof Effect!=="undefined"){w(L).appear({afterFinish:K})}else{if(typeof MooTools!=="undefined"&&typeof Fx!=="undefined"){L=w(L);if(L.getStyle("display")=="none"){L.setStyles({opacity:0,display:""});var J=new Fx.Tween(L,{onComplete:K});J.start("opacity",1)}}else{L.style.display="";K&&K()}}}}function o(L,K){if(D.hide){return D.hide(L,K)}if(D.hide===false){L.style.display="none";K&&K();return}if(typeof jQuery!=="undefined"){jQuery(L).fadeOut("slow",K)}else{if(typeof Prototype!=="undefined"&&typeof Effect!=="undefined"){w(L).fade({afterFinish:K})}else{if(typeof MooTools!=="undefined"&&typeof Fx!=="undefined"){L=w(L);var J=new Fx.Tween(L);J.start("opacity",0).chain(function(){L.setStyle("display","none");K&&K()})}else{L.style.display="none";K&&K()}}}}function f(K){if(D.activate){return D.activate(K)}try{K.focus();K.select&&K.select()}catch(J){}}function i(M,L){if(!L){return null}if(M.id&&L[M.id]){return L[M.id]}var K=c(M);var J=null;g(K,function(N){var O=L["."+N];if(O){J=O;return false}});return J}var m=function(){this.initialize.apply(this,arguments)};C(m.prototype,{initialize:function(K,J){this.test=(typeof K==="function")?{test:K}:K;this.options=J||{}},validate:function(J,K){return this.options.force?this._validate(J,K):(u(J)||this._validate(J,K))},_validate:function(J,K){return(this.options.depends?d(this.options.depends,function(L){return L.validate(J,K)}):true)&&(this.test===true||(this.test.validate||this.test.test).call(this.test,J,K))}});var h={};h.alert={fail:function(K,J){J&&window.alert(J)}};h["default"]={prompt:function(K,J){this._showAdvice(K,"prompt",J)},pass:function(K,J){this._showAdvice(K,"passed",J)},fail:function(K,J){this._showAdvice(K,"failed",J)},reset:function(K){var J=["prompt","passed","failed"];g(J,function(M){t(K,"validation-"+M);var L=this._getAdvice(K,M);if(!L){return}if(H(L,"validation")){L.parentNode&&L.parentNode.removeChild(L)}else{t(L,"validation-advice-"+M);L.style.display="none"}},this);a(K,"validation_advice_default")},_showAdvice:function(O,M,N){var K=["prompt","passed","failed"];g(K,function(P){(P==M?q:t)(O,"validation-"+P)});var J=this._getAdvice(O,M);if(!J&&N){J=this._createAdvice(O);this._setAdvice(O,J)}if(M=="prompt"&&(!J||(H(J,"validation")&&!N))){return}g(K,function(Q){if(Q==M){return}var P=this._getAdvice(O,Q);if(!P){return}if(J){t(P,"validation-advice-"+Q);P.style.display="none"}else{o(P,function(){t(P,"validation-advice-"+Q)})}},this);if(!J){return}if(N&&!H(J,"validation_message")){J.innerHTML="";var L=O.ownerDocument.createElement("span");L.innerHTML=N;J.appendChild(L)}if(N||H(J,"validation_message")){q(J,"validation-advice-"+M);E(J)}},_getAdvice:function(M,L){var K=H(M,"validation_advice_default")||H(M,"validation_advice_default",{});var J=K[L];if(J){return J}J=M.id?(k("validation-advice_"+L+"-"+M.id)||k("validation-advice-"+M.id)):null;J=J||k("validation-advice-"+L)||k("validation-advice");if(J){K[L]=J;A(J.innerHTML)&&H(J,"validation_message",true)}return J},_setAdvice:function(K,J){H(K,"validation_advice_default",{prompt:J,passed:J,failed:J})},_createAdvice:function(P){var O="validation-advice-"+(P.id||new Date().getTime());var J='<div id="'+O+'" class="validation-advice" style="display: none;"></div>';var N=P.ownerDocument.createElement("div");N.innerHTML=J;J=N.childNodes[0];H(J,"validation",true);var M=P.parentNode;var L=P.type.toLowerCase();if((L=="checkbox"||L=="radio")&&M){M.appendChild(J)}else{var K=P.nextSibling;K?M.insertBefore(J,K):M.appendChild(J)}return J}};C(D,{add:function(K,L,J){if(arguments.length==1){g(K,function(N,M){N=G(N);this.add.call(this,M,N[0],N[1])},this);return this}J=C({},J);validators=[];J.depends&&g(G(J.depends),function(N){var M=this.get(N);M&&validators.push(M)},this);J.depends=validators;this._validators[K]=new m(L,J);return this},get:function(J){if(typeof J==="string"){return this._validators[J]}if(r(J)=="form"){return H(J,"validation")}return null},validate:function(K,J){return this._dispatchCall(K,J,"validate")},validateElement:function(O,L){O=k(O);if(L===false){L={advice:false}}L=C({},D.defaultOptions,L);var N=this._validateElement(O,L);if(N==-3){return true}if(L.advice!==false){var K=this._getAdvice(L);if(!K){throw new Error("can not find the validation advice:"+L.advice)}H(O,"validation_advice",K);if(N==-1){if(K.pass){var M=this._getMessage(O,"passed",L);K.pass(O,M,L)}}else{if(K.fail){var M=this._getMessage(O,"failed",L,N==-2?false:N);K.fail(O,M,L)}}}var J=L.onElementValidate||L.onValidate;if(J&&J.call(O,N==-1,(N==-2)?0:N)===false){N=-1}return N==-1},validateForm:function(M,J){M=k(M);if(J===false){J={advice:false,focusOnError:false}}J=C({},D.defaultOptions,J);var K=n(M);var L=true;var N=[];if(J.stopOnFirst){L=d(K,function(P){var O=this._validateFormElement(P,J);if(!O){N.push(P)}return O},this)}else{g(K,function(O){if(!this._validateFormElement(O,J)){N.push(O);L=false}},this)}if(J.onFormValidate&&J.onFormValidate.call(M,L,J.stopOnFirst?N[0]:N)===false){L=false}!L&&J.focusOnError&&f(N[0]);return L},reset:function(J){return this._dispatchCall(J,null,"reset")},resetForm:function(J){g(n(k(J)),this.resetElement,this);return this},resetElement:function(K){K=k(K);var J=H(K,"validation_advice");J&&J.reset&&J.reset(K);a(K,"validation_advice");return this},prompt:function(M,K){M=k(M);if(this._getValidators(M,K).length==0){return}var J=this._getAdvice(K);var L=this._getMessage(M,"prompt",K);J&&J.prompt&&J.prompt(M,L,K)},_dispatchCall:function(M,J,L){M=k(M);var K=r(M)=="form"?"Form":"Element";return this[L+K](M,J)},_validateElement:function(O,L){var J=this._regularValidators(this._getValidators(O,L));if(J.length==0){return -3}var N=e(O);var K=-1;var M=d(J,function(P,R){var Q=(typeof P[0]==="string")?this.get(P[0]):new m(P[0],P[1]);if(!Q){throw new Error("can't find installed validator: "+P[0])}if(!Q.validate(N,P[1])){K=R;return false}return true},this);if(!M&&J.length==1){return -2}return K},_validateFormElement:function(N,K){var M=K.validators;var J=K.messages;K.validators=i(N,M);K.messages=i(N,J);var L=D.validateElement(N,K);K.validators=M;K.messages=J;return L},_getValidators:function(K,J){return J.validators||J.validator||this._getValidatorsFromElm(K)},_regularValidators:function(J){J=G(J);var K=[];g(J,function(L){var M=typeof L;if(M==="string"||M==="function"){K.push([L])}else{if(p(L)){K.push(L)}else{if(M==="object"){var N=L.validate||L.test;if(N&&typeof N==="function"){K.push([L])}else{g(L,function(O,P){this.get(P)&&K.push([P,O])},this)}}}}},this);return K},_getValidatorsFromElm:function(K){var J=[];g(c(K),function(M){var L=this._getValidatorFromClass(M);L&&J.push(L)},this);return J},_getValidatorFromClass:function(L){if(L!="required"&&L.indexOf("validate-")!=0){return null}L=L.replace(/^validate-/,"");if(this.get(L)){return L}var K=[];var N=(L+"-").match(/(-\[\S+?\](?=-))|[^-]+/g);for(var M=0,O=N.length;M<O-1;++M){var J=N.pop().replace(/^-\[(\S+)\]$/,"$1");K.unshift(J);L=N.join("-");if(this.get(L)){return[L,K]}}return null},_getMessage:function(O,M,K,J){var N=K.messages||K.message;if(N){if(typeof N==="string"||p(N)){N={failed:N}}if(M=="failed"){var L=G(N.failed);return L[J||0]||L[0]}else{return N[M]}}else{N=O.getAttribute((K.messageNames)[M]);if(!N&&M=="failed"&&K.useTitle){N=O.title}if(N&&M=="failed"&&J!==false){var L=N.split(K.messageSeparator);return L[J]||L[0]}return N}},_getAdvice:function(J){var K=typeof J.advice;if(K==="string"){return h[J.advice]}else{if(K==="function"){return{fail:J.advice}}else{if(K==="object"){return J.advice}else{throw"can not find advice."}}}}});C(D.prototype,{initialize:function(L,K){this.form=k(L);this.options=C({},D.defaultOptions,K);var J=H(this.form,"validation");if(J){J.stop();delete J}this.options.autoStart&&this.start();H(this.form,"validation",this)},start:function(){if(this.running){return this}this.running=true;this.options.immediate&&this._handleElms();this.options.onSubmit&&this._handleSubmit();this.options.onReset&&this._handleReset();return this},stop:function(){if(!this.running){return this}this.running=false;this.reset();g(n(this.form),this._removeEvent,this);this._removeEvent(this.form);return this},restart:function(){return this.stop().start()},validate:function(J){if(J===false){J={advice:false,focusOnError:false}}J=C({},this.options,J);return D.validateForm(this.form,J)},reset:function(){D.resetForm(this.form);return this},_handleSubmit:function(){var J=I(function(K){if(!this.validate()){B(K)}},this);this._addEvent(this.form,"submit",J)},_handleReset:function(){var J=I(function(){this.reset()},this);this._addEvent(this.form,"reset",J)},_handleElms:function(){var J=this.options;var K=n(this.form);var L=J.immediate=="keypress"?"keypress":"blur";g(K,function(Q){var O=function(){return D._validateFormElement(Q,J)};var P=O;var M=r(Q);if(M!="select"&&L=="keypress"){P=function(){if(H(Q,"validation_running")){return}H(Q,"validation_running",true);var R=(J.delay||0.5)*1000;setTimeout(O,R);setTimeout(function(){a(Q,"validation_running")},R)}}var N=I(function(){var R=J.messages;J.messages=i(Q,R);D.prompt(Q,J);J.messages=R},this);this._addEvent(Q,M=="select"?"blur":L,P);this._addEvent(Q,"focus",N)},this)},_addEvent:function(M,L,K){var J=H(M,"validation_handler")||H(M,"validation_handler",[]);J.push([L,K]);x(M,L,K)},_removeEvent:function(K){var J=H(K,"validation_handler");J&&g(J,function(L){y(K,L[0],L[1])});a(K,"validation_handler")}});D.util={each:g,all:d,any:s,extend:C,isEmpty:u,isArray:p,splat:G,trim:A};D.ui={get:k,getTag:r,getValue:e,data:H,addEvent:x,removeEvent:y,stopEvent:B,getClasses:c,hasClass:b,addClass:q,removeClass:t,show:E,hide:o,activate:f};D.advice=h;D.Validator=m;window.Validation=D;D.noConflict=function(){window.Validation=j;return D};D.autobind=true;if(D.autobind){x(window,"load",function(){var J=document.getElementsByTagName("form");g(J,function(K){if(b(K,"required-validate")){new D(K,{immediate:true})}})})}D.defaultOptions={autoStart:true,advice:"default",messageNames:{prompt:"promptmessage",passed:"passedmessage",failed:"failedmessage"},useTitle:true,messageSeparator:/;\s*/,stopOnFirst:true,focusOnError:true,onSubmit:true,onReset:true};D._validators={};D._validators.required={validate:function(J){return !u(J)}};D.add({integer:/^[-+]?[\d]+$/,"float":/^[-+]?\d+(\.\d+)?$/,digits:/^\d+$/,alpha:/^[a-zA-Z]+$/,alphanum:/^[a-zA-Z0-9]+$/,identifier:/^_*[a-zA-Z]\w*$/,"less-than":[function(K,J){return parseFloat(K)<J},{depends:"float"}],"great-than":[function(K,J){return parseFloat(K)>J},{depends:"float"}],length:function(K,J){return K.length==J},"min-length":function(K,J){return K.length>=J},"max-length":function(K,J){return K.length<=J},"int-range":[function(J,K){J=parseInt(J);return J>=K[0]&&J<=K[1]},{depends:"integer"}],"float-range":[function(J,K){J=parseFloat(J);return J>=K[0]&&J<=K[1]},{depends:"float"}],"length-range":function(J,K){return J.length>=K[0]&&J.length<=K[1]},file:function(J,K){K=G(K);return s(K,function(L){return new RegExp("\\."+L+"$","i").test(J)})},date:function(V,U){U=U||"y-m-d";U=G(U).join("-");var M=U.replace(/[^ymd]/g,"");var W=["\\","\\\\","/","\\/",".","\\.","d","(\\d{1,2})","y","(\\d{4}|\\d{2})","m","(\\d{1,2})"];for(var N=0,S=W.length;N<S;N+=2){U=U.replace(W[N],W[N+1])}var L=V.match(new RegExp("^"+U+"$"));if(!L){return false}var Q=M.indexOf("y");var K=M.indexOf("m");var O=M.indexOf("d");var R=Q!=-1?L[Q+1]:0;var P=K!=-1?L[K+1]:0;var T=O!=-1?L[O+1]:0;var J=new Date();if(R&&R.length==2){R=2000+R;R=R>J.getFullYear()?R-1000:R}R&&J.setFullYear(R);P&&J.setMonth(P-1);T&&J.setDate(T);if(R&&J.getFullYear()!=R||P&&J.getMonth()!=P-1||T&&J.getDate()!=T){return false}return true},time:function(K){var J=K.match(/^(\d{1,2}):(\d{1,2})(:(\d{1,2}))?$/);if(!J){return false}return parseInt(J[1])<24&&parseInt(J[2])<60&&(!J[4]||parseInt(J[4])<60)},datetime:function(J,L){var K=J.split(/\s+/);if(K.length!=2){return false}var N=D.get("date");var M=D.get("time");return N.validate(K[0],L)&&M.validate(K[1])},email:/\w{1,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/,url:/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i,ip:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,"id-number":function(K){if(!(/^\d{17}(\d|x)$/i.test(K)||/^\d{15}$/i.test(K))){return false}var M=parseInt(K.substr(0,2));if(M<11||M>91){return false}var J=K.length==18?K:K.substr(0,6)+"19"+K.substr(6,15);var N=J.substr(6,8);if(!new Date(N.substr(0,4)+"/"+N.substr(4,2)+"/"+N.substr(6,2))){return false}if(K.length==18){K=K.replace(/x$/i,"a");var O=0;for(var L=17;L>=0;L--){O+=(Math.pow(2,L)%11)*parseInt(K.charAt(17-L),11)}if(O%11!=1){return false}}return true},chinese:/^[\u4e00-\u9fa5]+$/,telephone:/^((0[1-9]{3})?(0[12][0-9])?-?)?\d{6,8}$/,mobilephone:/(^0?[1][35][0-9]{9}$)/,zip:/^[1-9]\d{5}$/,qq:/^[1-9]\d{4,8}$/,pattern:function(J,K){K=G(K).join("-");return new RegExp(K).test(J)},equals:[function(K,J){return K==e(k(G(J).join("-")))},{force:true}],"required-any":[function(J,K){return !u(J)||s(G(K),function(L){return !u(e(k(L)))})},{force:true}],any:function(J,K){return s(G(K),function(L){return D.get(L).validate(J)})},multi:function(J,K){K=G(K);var M=J.split(new RegExp(K[1]||"\\s+"));var L=D.get(K[0]);return d(M,function(N){return L.validate(N)})},within:function(J,K){return s(G(K),function(L){return J==L})},notwithin:function(J,K){return d(G(K),function(L){return J!=L})}});D.ajax=function(){window.alert("can not find ajax library(prototype mootools or jquery).")};D.ajaxValidate=function(J){return/\s*true\s*/.test(J)};D.add("ajax",function(K,M){M=G(M);var L=M[0];var P=M[1]||"value";var O={};O[P]=K;var J=false;var Q=function(R){J=D.ajaxValidate(R)};if(typeof jQuery!=="undefined"){jQuery.ajax({url:L,type:"POST",async:false,data:O,success:Q})}else{if(typeof Prototype!=="undefined"){new Ajax.Request(L,{asynchronous:false,parameters:O,onSuccess:function(R){Q(R.responseText)}})}else{if(typeof MooTools!=="undefined"){var N=new Request({url:L,async:false,data:O});N.addEvent("success",Q);N.send()}else{D.ajax({url:L,data:O,success:Q})}}}return J})})();